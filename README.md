# ğŸ˜¸ğŸ¶ ë°˜ë ¤ë™ë¬¼ í†µí•©ê´€ë¦¬ ì‹œìŠ¤í…œ ë° ì œì–´ ì•±

<div align="right">
  ë§ˆì´í¬ë¡œí”„ë¡œì„¸ì„œë°ì‹¤í—˜
  ğŸ—“ï¸ 2022.04.23 - 2022.06.12
</div>
<br>

<img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/7af1e863-98ca-49eb-a4d4-3a53ab0cba89">
<br><br>

## ë©”ì¸ ì•„ì´ë””ì–´
- ì§‘ì— í˜¼ì ìˆëŠ” ë°˜ë ¤ë™ë¬¼ì„ ì–´ë–»ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆì„ê¹Œ â“
- ì‚¬ë£Œ ê¸‰ì—¬, ì˜ìƒ ì‹œì²­, ì˜¨ìŠµë„ í™•ì¸, ë…¹ìŒ ê¸°ëŠ¥ì„ í†µí•©í•˜ì—¬ ì œì–´í•˜ì ğŸ’¡
- ë¼ì¦ˆë² ë¦¬íŒŒì´ì™€ ì—¬ëŸ¬ ì„¼ì„œë¥¼ ì‚¬ìš©í•´ ìë™ ê¸‰ì‹ê¸°ì™€ ì•ˆë“œë¡œì´ë“œ ì•± ì œì‘ ğŸ“²
<br>

## ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤
<!--ë©”ì¸í™”ë©´-->
<h3 align="center">
  ì—¬ëŸ¬ ê¸°ëŠ¥ì„ í†µí•©í•˜ì—¬ ê°„í¸í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”! ğŸ‘ 
</h3>
<div align="center">
  <img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/830279f7-36f0-4b29-a0ff-29bfd952b2d5" width="249" height="443"/>
</div>
<hr>
    
<!--ì˜¨ìŠµë„-->
<h3 align="center">
  ì˜¨ìŠµë„ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•´ë´ìš”! ğŸŒ¡ğŸ’§
</h3>
<div align="center">

  **ì£¼ë³€ í™˜ê²½ì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš” ğŸ¤** <br><br>
  <img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/f629a18f-aebc-47ea-8fa4-d360ad3de940" width="50%" height="auto"/>
</div>
<hr>

<!--ì‚¬ë£Œê¸‰ì—¬-->
<h3 align="center">
  ì‹œê°„ì„ ì¡°ì ˆí•˜ì—¬ ì‚¬ë£Œë¥¼ ê¸‰ì—¬í•´ë´ìš”! ğŸ´
</h3>
<div align="center">
  
   **ì›í•˜ëŠ” ì–‘ì˜ ì‚¬ë£Œë¥¼ ê¸‰ì—¬í•  ìˆ˜ ìˆì–´ìš” ğŸ¤** <br><br>
  <img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/ae1c9419-3679-4ac7-bf85-fbded3d5575d" width="249" height="443"/>
  <br><br>
  ë°”ë¥¼ ì›€ì§ì—¬ì„œ ì›í•˜ëŠ” ì‚¬ë£Œ ì–‘ì„ ì¡°ì ˆí•´ìš”.
</div>
<hr>

<!--ì˜ìƒì‹œì²­-->
<h3 align="center">
  ì§€ê¸ˆ ë‹¹ì¥ ë°˜ë ¤ë™ë¬¼ì˜ ì˜ìƒì„ ì‹œì²­í•´ë´ìš”! ğŸ‘€
</h3>
<div align="center">
  
  **ì§€ê¸ˆ ë¬´ì—‡ì„ í•˜ê³ ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆì–´ìš” ğŸ¤** <br><br>
  <img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/c613e320-c512-40c7-b5ea-40ab7e841721" width="249" height="443"/>
</div>
<hr>

<!--ë…¹ìŒê¸°ëŠ¥-->
<h3 align="center">
  ë°˜ë ¤ë™ë¬¼ì—ê²Œ ì—¬ëŸ¬ë¶„ì˜ ëª©ì†Œë¦¬ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”! ğŸ”Š
</h3>
<div align="center">
  
  **ë§ˆì´í¬ë¥¼ ëˆŒëŸ¬ ë…¹ìŒí•˜ê³  ë‚´ìš©ì„ í™•ì¸ í›„ ì „ì†¡í•  ìˆ˜ ìˆì–´ìš” ğŸ¤** <br><br>
  <img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/cac637e5-8418-4687-9c10-7dabaf6524b8" width="249" height="443"/>
  <br><br>
  ë§ˆì´í¬ë¥¼ ëˆŒëŸ¬ ë…¹ìŒì„ ì‹œì‘í•˜ê³  ë‹¤ì‹œ ëˆŒëŸ¬ ë…¹ìŒì„ ì¢…ë£Œí•´ìš”.<br><br>
  ì¬ìƒ ë° ì •ì§€ ë²„íŠ¼ì„ í†µí•´ ë…¹ìŒ ë‚´ìš©ì„ í™•ì¸í•´ìš”.<br><br>
  ì „ì†¡ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë°˜ë ¤ë™ë¬¼ì—ê²Œ ëª©ì†Œë¦¬ë¥¼ ê³µìœ í•´ë´ìš”.
</div>
<br>

## ì—­í•  ë¶„ë‹´
<!--í‘œ ì¶”ê°€-->
|íŒ€ì¥|íŒ€ì›|íŒ€ì›|
|:---:|:---:|:---:|
|[ì˜¤ì†Œì˜](https://github.com/irrso)|***|***|
|ì•± ì„¤ê³„ ë° ì œì‘ <br> ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ <br> ë°œí‘œ ìë£Œ ì œì‘ ë° ì œì¶œ <br> í•„ìš” ë¬¼í’ˆ ë¦¬ìŠ¤íŠ¸ì—… ë° ìˆ˜ë ¹ <br> ì½”ë“œ í˜•ìƒê´€ë¦¬|ì•± ì œì‘ <br> firebase ë°ì´í„° ì „ì†¡ ê´€ë¦¬ ë° êµ¬í˜„ <br> í”„ë¡œì íŠ¸ ì œì•ˆ ë° ìµœì¢… ë°œí‘œ|ìë™ ê¸‰ì‹ê¸° ì œì‘ ë° ì„¼ì„œ ë¶€ì°© <br> ë¼ì¦ˆë² ë¦¬íŒŒì´ ì„¼ì„œ íšŒë¡œ ì„¤ê³„ ë° ì½”ë“œ êµ¬í˜„|
<br>

## ê¸°ìˆ  ìŠ¤íƒ
|ë¶„ë¥˜|ê¸°ìˆ  ìŠ¤íƒ|
|---|---|
|S/W|<img src="https://img.shields.io/badge/Android-34A853.svg?style=flat-square&logo=android&logoColor=white"/> <img src="https://img.shields.io/badge/Android Studio-3DDC84.svg?style=flat-square&logo=androidstudio&logoColor=white"/> <img src="https://img.shields.io/badge/Java(JDK1.8)-007396.svg?style=flat-square&logo=java&logoColor=white"/>|
|H/W|<img src="https://img.shields.io/badge/Raspbian GNU/Linux 11-A22846.svg?style=flat-square&logo=raspberrypi&logoColor=white"/> <img src="https://img.shields.io/badge/Firebase-FFCA28.svg?style=flat-square&logo=firebase&logoColor=white"/> <img src="https://img.shields.io/badge/C-A8B9CC.svg?style=flat-square&logo=c&logoColor=black"/> <img src="https://img.shields.io/badge/Python-3776AB.svg?style=flat-square&logo=python&logoColor=white"/>|
|í˜‘ì—…|<img src="https://img.shields.io/badge/KakaoTalk-FFCD00.svg?style=flat-square&logo=kakaotalk&logoColor=black"/> <img src="https://img.shields.io/badge/Google Docs-4285F4.svg?style=flat-square&logo=googledocs&logoColor=white"/> <img src="https://img.shields.io/badge/GitHub-181717.svg?style=flat-square&logo=github&logoColor=white"/>|

### ë¼ì¦ˆë² ë¦¬íŒŒì´
- `piì¹´ë©”ë¼`ë¥¼ ì´ìš©í•˜ì—¬ ì˜ìƒ ì†¡ì¶œ
- `ì„œë³´ëª¨í„°`ë¥¼ ì´ìš©í•˜ì—¬ ì‚¬ë£Œ ê¸‰ì—¬
- `ìŠ¤í”¼ì»¤`ë¥¼ ì´ìš©í•˜ì—¬ ìŒì„± ì¬ìƒ
- `ì˜¨ìŠµë„ì„¼ì„œ`ë¥¼ ì´ìš©í•˜ì—¬ ì˜¨ìŠµë„ í‘œì‹œ

### firebase
- `feed`í‚¤ë¥¼ í†µí•´ ì‚¬ë£Œ ê´€ë ¨ ë°ì´í„° ì†¡ìˆ˜ì‹ 
- `voice`í‚¤ì™€ `recorded.wav`íŒŒì¼ì„ í†µí•´ ìŒì„± ë°ì´í„° ì†¡ìˆ˜ì‹ 
- `humidity`, `temperature`í‚¤ë¥¼ í†µí•´ ì˜¨ìŠµë„ ê´€ë ¨ ë°ì´í„° ì†¡ìˆ˜ì‹ 
<br>

## ì‹œìŠ¤í…œ ê°œìš”
- ë¼ì¦ˆë² ë¦¬íŒŒì´: ìë™ ê¸‰ì‹ê¸°ì— ë¶€ì°©ëœ ì„¼ì„œ ì œì–´, piì¹´ë©”ë¼ë¥¼ ìœ„í•œ ì›¹ í˜¸ìŠ¤íŒ… ì—­í• 
- ìŠ¤ë§ˆíŠ¸í°: ì•±ì„ í†µí•´ ë¼ì¦ˆë² ë¦¬íŒŒì´ì— ë°ì´í„° ì „ì†¡ ë° ìˆ˜ì‹ , ìë™ ê¸‰ì‹ê¸° ë…¼ë¦¬ì ìœ¼ë¡œ ì œì–´í•˜ëŠ” UI ì—­í• 
- firebase: ë¼ì¦ˆë² ë¦¬íŒŒì´ì™€ ìŠ¤ë§ˆíŠ¸í° ì•± ê°„ì˜ ì „ì†¡ ë§¤ê°œì²´ ì—­í• , ë¡œì»¬ì— êµ­í•œë˜ì§€ ì•Šì€ ì œì–´ êµ¬í˜„ [^id]
[^id]: ğŸš© piì¹´ë©”ë¼ë¥¼ í†µí•œ ì•ˆì‹¬ ì¹´ë©”ë¼ ê¸°ëŠ¥ì€ ë„ë©”ì¸ ì„¤ì • ë° í¬ì›Œë”© ë“±ì˜ ë¬¸ì œê°€ ë°œìƒí•´ ë¡œì»¬ë¡œë§Œ ì‹¤í–‰í•˜ë„ë¡ êµ¬ìƒ

|ì‹œìŠ¤í…œ êµ¬ìƒë„|ì‹œìŠ¤í…œ íšŒë¡œë„|
|:---:|:---:|
|<img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/da9fe625-0e86-44f8-921f-4677c05e7bb0" width="110%" height="auto">|<img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/35fbeb12-c7a2-445e-906e-0ab6babcbbe3" width="90%" height="auto">|
<br>

## ì‹œìŠ¤í…œ ê¸°ëŠ¥
### ìë™ ê¸‰ì‹ê¸°
- ëª¨í„°ë¥¼ í†µí•´ ìë™ìœ¼ë¡œ ì‚¬ë£Œë¥¼ ê³µê¸‰í•˜ëŠ” í•˜ë“œì›¨ì–´
<img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/b0c532bc-ccbd-4e18-9b02-636d6e09e354" width="25%" height="auto"/>

<details>
    <summary> <img src="https://img.shields.io/badge/MainActivity.Java-007396.svg?style=flat-square"/> </summary>

  ```Java
        //feed ì´ˆê¸°ê°’
        dbReference = FirebaseDatabase.getInstance().getReference();
        dbReference.child("feed").setValue(0);

        //ì‚¬ë£Œì£¼ê¸°
        seekBar.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {
            @Override
            public void onProgressChanged(SeekBar seekBar, int i, boolean b) {
                progress = i * 0.5;
                se.setText(progress + "ì´ˆ");
            }

            @Override
            public void onStartTrackingTouch(SeekBar seekBar) {

            }

            @Override
            public void onStopTrackingTouch(SeekBar seekBar) {

            }
        });

        feedBtn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                dbReference.child("feed").setValue(progress);
                Handler mHandler = new Handler();
                Toast.makeText(getApplicationContext(), "ì‚¬ë£Œì£¼ê¸° ì™„ë£Œ", Toast.LENGTH_SHORT).show();
            }
        });
  ```
</details>

<details>
    <summary> <img src="https://img.shields.io/badge/servo_firebase.py-3776AB.svg?style=flat-square"/> </summary>

  ```Python
import RPi.GPIO as GPIO
import time;

# firebase
import firebase_admin
from firebase_admin import credentials
from firebase_admin import db

#firebase auth and init
cred = credentials.Certificate('firebaseKey.json')
firebase_admin.initialize_app(cred,{
    'databaseURL' : 'https://mptest-48b84-default-rtdb.firebaseio.com/'
    })

dir = db.reference()
GPIO.setmode(GPIO.BCM)
GPIO.setup(2,GPIO.OUT)
a = GPIO.PWM(2,50)
            
while True:
    feedtime = dir.child('feed').get()
    print("feed : "+str(feedtime))
    if feedtime != 0:
        dir.update({'feed' : 0})
        GPIO.output(2, True)
        a.start(0)
        a.ChangeDutyCycle(1.2)
        time.sleep(feedtime)
        a.ChangeDutyCycle(6.8)
        GPIO.output(2, False)
        time.sleep(1)
    else:
        a.start(0)
        time.sleep(1)
    
GPIO.cleanup()
  ```
</details>

### ì•ˆì‹¬ ì¹´ë©”ë¼
- í˜¼ì ìˆëŠ” ë°˜ë ¤ë™ë¬¼ì„ ì´¬ì˜í•˜ëŠ” ì¹´ë©”ë¼
<img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/1b4a1cdd-0f4e-4112-a24d-94c921048e4e" width="25%" height="auto"/>

<details>
    <summary> <img src="https://img.shields.io/badge/MainActivity.Java-007396.svg?style=flat-square"/> </summary>

  ```Java
         //ì˜ìƒë³´ê¸°
        videoBtn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Intent intent = new Intent(getApplicationContext(), VideoActivity.class);
                startActivity(intent);
            }
        });
  ```
</details>

<details>
    <summary> <img src="https://img.shields.io/badge/play.py-3776AB.svg?style=flat-square"/> </summary>

  ```Python
import io
import picamera
import logging
import socketserver
import RPi.GPIO as GPIO
import time

from threading import Condition
from http import server

PAGE="""\
<html>
<head>
</head>
<body>
<img src="stream.mjpg" width="640" height="480" />
</body>
</html>
"""
def play():
    GPIO.setmode(GPIO.BCM)
    gpio_pin = 12
    scale = [261, 294, 329, 349, 392, 440, 493, 523]
    GPIO.setup(gpio_pin, GPIO.OUT)
    list = [1,2,3,4,5,6,7,8]

    try:
        p = GPIO.PWM(gpio_pin, 100)
        p.start(100)
        p.ChangeDutyCycle(90)
    
        for i in range(9):
            p.ChangeFrequency(scale[list[i]])
            if i == 6:
                time.sleep(1)
            else:
                time.sleep(0.5)       
        p.stop()
    finally:
        GPIO.cleanup()



#play()

class StreamingOutput(object):
    def __init__(self):
        self.frame = None
        self.buffer = io.BytesIO()
        self.condition = Condition()

    def write(self, buf):
        if buf.startswith(b'\xff\xd8'):
            # New frame, copy the existing buffer's content and notify all
            # clients it's available
            self.buffer.truncate()
            with self.condition:
                self.frame = self.buffer.getvalue()
                self.condition.notify_all()
            self.buffer.seek(0)
        return self.buffer.write(buf)

class StreamingHandler(server.BaseHTTPRequestHandler):
    def do_GET(self):
        if self.path == '/':
            self.send_response(301)
            self.send_header('Location', '/index.html')
            self.end_headers()
        elif self.path == '/index.html':
            content = PAGE.encode('utf-8')
            self.send_response(200)
            self.send_header('Content-Type', 'text/html')
            self.send_header('Content-Length', len(content))
            self.end_headers()
            self.wfile.write(content)
        elif self.path == '/stream.mjpg':
            self.send_response(200)
            self.send_header('Age', 0)
            self.send_header('Cache-Control', 'no-cache, private')
            self.send_header('Pragma', 'no-cache')
            self.send_header('Content-Type', 'multipart/x-mixed-replace; boundary=FRAME')
            self.end_headers()
            try:
                while True:
                    with output.condition:
                        output.condition.wait()
                        frame = output.frame
                    self.wfile.write(b'--FRAME\r\n')
                    self.send_header('Content-Type', 'image/jpeg')
                    self.send_header('Content-Length', len(frame))
                    self.end_headers()
                    self.wfile.write(frame)
                    self.wfile.write(b'\r\n')
            except Exception as e:
                logging.warning(
                    'Removed streaming client %s: %s',
                    self.client_address, str(e))
        else:
            self.send_error(404)
            self.end_headers()

class StreamingServer(socketserver.ThreadingMixIn, server.HTTPServer):
    allow_reuse_address = True
    daemon_threads = True

with picamera.PiCamera(resolution='640x480', framerate=24) as camera:
    output = StreamingOutput()
    camera.start_recording(output, format='mjpeg')
    try:
        address = ('', 8000)
        server = StreamingServer(address, StreamingHandler)
        server.serve_forever()
    finally:
        camera.stop_recording()
  ```
</details>

### ì•ˆì‹¬ ìŠ¤í”¼ì»¤
- ì•±ì„ í†µí•´ ì „ë‹¬ëœ ìŒì„± ë…¹ìŒì„ ë°˜ë ¤ë™ë¬¼ì—ê²Œ ë“¤ë ¤ì£¼ëŠ” ìŠ¤í”¼ì»¤
<img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/c2eeb952-86e2-413c-9134-7ef5b4603876" width="25%" height="auto"/>

<details>
    <summary> <img src="https://img.shields.io/badge/MainActivity.Java-007396.svg?style=flat-square"/> </summary>

  ```Java
        //ë…¹ìŒí•˜ê¸°
        voiceBtn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Intent intent = new Intent(getApplicationContext(), VoiceActivity.class);
                startActivity(intent);
            }
        });
  ```
</details>

<details>
    <summary> <img src="https://img.shields.io/badge/voice.py-3776AB.svg?style=flat-square"/> </summary>

  ```Python
import pyrebase
import vlc
import time

import firebase_admin
from firebase_admin import credentials
from firebase_admin import db

config = {
    "apiKey": "AIzaSyB7Rzk4o11hX1tkJJYleUoQPsIVcCPWoJw",
    "authDomain": "mptest-48b84.firebaseapp.com",
    "databaseURL": "https://mptest-48b84-default-rtdb.firebaseio.com",
    "projectId": "mptest-48b84",
    "storageBucket": "mptest-48b84.appspot.com",
    "messagingSenderId": "229031734122",
    "appId": "1:229031734122:web:7f43734df59079c0e45313"
    }

cred = credentials.Certificate('firebaseKey.json')
firebase_admin.initialize_app(cred,{
    'databaseURL' : 'https://mptest-48b84-default-rtdb.firebaseio.com/'
    })

dir = db.reference()

while True:
    voiceflag = dir.child('voice').get()
    print("voice : "+ str(voiceflag))
    
    if voiceflag:
        dir.update({'voice':False})
        time.sleep(4)
        firebase = pyrebase.initialize_app(config)
        storage = firebase.storage()
        storage.child("voice/recorded.wav").download("recorded_d.wav")
        time.sleep(4)
        p = vlc.MediaPlayer("recorded_d.wav")
        p.play()
    else:
        time.sleep(1)
  ```
</details>

### ì•ˆì‹¬ ì˜¨ìŠµë„
- ë°˜ë ¤ë™ë¬¼ì˜ í™˜ê²½ì´ ì¾Œì í•œ ì˜¨ìŠµë„ì¸ì§€ í™•ì¸í•˜ëŠ” ì‹œìŠ¤í…œ
<img src="https://github.com/irrso/microprocessor-integrated-pet-management-system/assets/105829324/3472a320-cd57-4558-9b03-66730bbde50f" width="25%" height="auto"/>

<details>
    <summary> <img src="https://img.shields.io/badge/MainActivity.Java-007396.svg?style=flat-square"/> </summary>

  ```Java
        //ì˜¨ìŠµë„
        database = FirebaseDatabase.getInstance();
        myRef = database.getReference("temphumi");

        myRef.addValueEventListener(new ValueEventListener() {
            @Override
            public void onDataChange(@NonNull DataSnapshot snapshot) {
                Double value1 = snapshot.child("temperature").getValue(Double.class);
                Double value2 = snapshot.child("humidity").getValue(Double.class);
                te.setText(value1+"Â°C"); //"\'C"
                hu.setText(value2+"%");
            }

            @Override
            public void onCancelled(@NonNull DatabaseError error) {
            }
        });
  ```
</details>

<details>
    <summary> <img src="https://img.shields.io/badge/temper_humi.py-3776AB.svg?style=flat-square"/> </summary>

  ```Python
import RPi.GPIO as GPIO
import time;
import Adafruit_DHT

# firebase
import firebase_admin
from firebase_admin import credentials
from firebase_admin import db

#firebase auth and init
cred = credentials.Certificate('firebaseKey.json')
firebase_admin.initialize_app(cred,{
    'databaseURL' : 'https://mptest-48b84-default-rtdb.firebaseio.com/'
    })

sensor = Adafruit_DHT.DHT11

while(True):
    humidity, temperature = Adafruit_DHT.read_retry(sensor, 17)
    if humidity is not None and temperature is not None:
        print('Temp {0:0.1f}*c Humidty = {1:0.1f}%'.format(temperature ,humidity))
        temp = temperature
        humi = humidity
        dir = db.reference('temphumi')
        dir.update({'temperature':temp})
        dir.update({'humidity':humi})
    
    
    else:
        print('fail')

    time.sleep(3)

GPIO.cleanup()
  ```
</details>
